(this.webpackJsonppublic=this.webpackJsonppublic||[]).push([[0],{153:function(e,t,n){},173:function(e,t,n){},187:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(54),s=n.n(c),i=(n(153),n(19)),o=n(3),d=n(18),l=n(10),u=n.n(l),j=n(16),h=n(7),b=n(122),m=n(248),p=n(250),x=n(15),O=n.n(x),g=(n(173),n(90)),f=n(123),y=n(242),v=n(0);function C(e){return Object(v.jsxs)("div",{children:[Object(v.jsx)(y.a,{onClick:e.signOut,children:"Sign out"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("products")},children:"Products list(as admin)"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("orders")},children:"Users' orders"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("account")},children:"Account"})]})}function _(e){return Object(v.jsxs)("div",{children:[Object(v.jsx)(y.a,{onClick:e.signOut,children:"Sign out"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("products")},children:"Products list(as user)"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("orders")},children:"Orders"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("cart")},children:"Cart"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("account")},children:"Account"})]})}function k(e){return Object(v.jsx)("div",{children:Object(v.jsx)(f.a,{open:e.menuList,onClose:e.handleMenuList,anchorEl:e.anchorEl,children:e.user?e.user.admin?Object(v.jsx)(C,{handleMenuList:e.handleMenuList,handleSelected:e.handleSelected,signOut:e.signOut}):Object(v.jsx)(_,{handleMenuList:e.handleMenuList,handleSelected:e.handleSelected,signOut:e.signOut}):Object(v.jsxs)("div",{children:[Object(v.jsx)(y.a,{onClick:e.handleSignInDialog,children:"Sign in"}),Object(v.jsx)(y.a,{onClick:e.handleSignUpDialog,children:"Sign up"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("products")},children:"Products list"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("cart")},children:"Cart"}),Object(v.jsx)(y.a,{onClick:function(){return e.handleSelected("orders")},children:"Orders"})]})})})}var w=n.p+"static/media/free.091d0987.svg";function S(){return Object(v.jsx)("div",{children:Object(v.jsx)("img",{src:w,alt:"logo",className:"logo"})})}var P=n(243),U=n(259),D=n(263),A=n(253),N=n(246),q=n(264),I=n(240),L=n(258),W=n(257),M=n(245),E=n(239),z=n(244);function B(e){return Object(v.jsx)("div",{children:Object(v.jsx)(P.a,{open:e.open,onClose:e.onClose,children:Object(v.jsx)(p.a,{item:!0,children:Object(v.jsxs)(p.a,{container:!0,spacing:3,children:[Object(v.jsx)(p.a,{item:!0,xs:2,children:Object(v.jsx)(z.a,{required:!0,id:"number",name:"number",label:"Number",fullWidth:!0,autoComplete:"shipping address-number",variant:"standard",value:e.state.number,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:10,children:Object(v.jsx)(z.a,{required:!0,id:"address1",name:"address1",label:"Address line 1",fullWidth:!0,autoComplete:"shipping address-line1",variant:"standard",value:e.state.address1,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{id:"address2",name:"address2",label:"Address line 2",fullWidth:!0,autoComplete:"shipping address-line2",variant:"standard",value:e.state.address2,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{required:!0,id:"city",name:"city",label:"City",fullWidth:!0,autoComplete:"shipping address-city",variant:"standard",value:e.state.city,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{id:"region",name:"region",label:"Region",fullWidth:!0,variant:"standard",value:e.state.region,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{required:!0,id:"postcode",name:"postcode",label:"Postcode",fullWidth:!0,autoComplete:"shipping postal-code",variant:"standard",value:e.state.postcode,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{required:!0,id:"country",name:"country",label:"Country",fullWidth:!0,autoComplete:"shipping country",variant:"standard",value:e.state.country,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,children:Object(v.jsx)(L.a,{onClick:e.editUser,children:"add address"})})]})})})})}var T=n(260),K=n(261),F=Object(v.jsx)(U.a,{component:"span",sx:{display:"inline-block",mx:"2px",transform:"scale(0.8)"},children:"\u2022"});function X(e){return Object(v.jsx)(U.a,{sx:{minWidth:275},children:Object(v.jsx)(T.a,{variant:"outlined",children:Object(v.jsxs)(K.a,{children:[Object(v.jsx)(g.a,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:"Address details"}),Object(v.jsxs)(g.a,{variant:"h5",component:"div",children:[e.user.address.number,F,e.user.address.line1,F,e.user.address.city,F,e.user.address.region,F,e.user.address.country,F,e.user.address.postcode]}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)(g.a,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:"First and Last name"}),Object(v.jsxs)(g.a,{variant:"body2",children:[e.user.firstName,F,e.user.lastName]})]})})})}function G(e){var t=r.a.useState(!1),n=Object(h.a)(t,2),c=n[0],s=n[1],i=function(){s(!c)};return Object(a.useEffect)((function(){console.log(e.state),console.log(e.user)}),[]),Object(v.jsxs)("div",{children:[Object(v.jsx)(B,{open:c,onClose:i,handleChange:e.handleChange,state:e.state,user:e.user,editUser:e.editUser}),Object(v.jsx)(g.a,{variant:"h6",gutterBottom:!0,children:"Shipping address"}),Object(v.jsxs)(W.a,{fullWidth:!0,children:[Object(v.jsx)(M.a,{id:"select-shipping-method",children:"Shipping method"}),Object(v.jsxs)(E.a,{labelId:"select-shipping-method",id:"dselect-shipping-method",value:e.shippingMethod,label:"Shipping method",onChange:e.handleShippingMethodSelect,children:[Object(v.jsx)(y.a,{value:"delivery",children:"Delivery"}),Object(v.jsx)(y.a,{value:"pick-up",children:"Pick up"})]})]}),e.user?"delivery"===e.shippingMethod?Object(v.jsxs)("div",{children:[Object(v.jsx)(X,{user:e.user,handleDeliveryFormDialog:i}),Object(v.jsx)(L.a,{size:"small",onClick:i,children:"Use another address"})]}):null:Object(v.jsx)("div",{children:Object(v.jsx)("button",{onClick:e.handleSignInDialog,children:"sign in"})}),Object(v.jsx)("br",{}),e.user||"delivery"!==e.shippingMethod?e.user||"pick-up"!==e.shippingMethod?null:Object(v.jsxs)("div",{children:[Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{required:!0,id:"email",name:"email",label:"Email",fullWidth:!0,autoComplete:"email",variant:"standard",value:e.state.email,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{required:!0,id:"password",name:"password",label:"Password",type:"password",fullWidth:!0,autoComplete:"password",variant:"standard",value:e.state.password,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{required:!0,id:"password2",name:"password2",label:"Password2",type:"password",fullWidth:!0,autoComplete:"password2",variant:"standard",value:e.state.password2,onChange:e.handleChange})})]}):Object(v.jsx)("div",{children:Object(v.jsx)(p.a,{item:!0,children:Object(v.jsxs)(p.a,{container:!0,spacing:3,children:[Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{required:!0,id:"email",name:"email",label:"Email",fullWidth:!0,autoComplete:"email",variant:"standard",value:e.state.email,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{required:!0,id:"password",name:"password",label:"Password",type:"password",fullWidth:!0,autoComplete:"password",variant:"standard",value:e.state.password,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{required:!0,id:"password2",name:"password2",label:"Password2",type:"password",fullWidth:!0,autoComplete:"password2",variant:"standard",value:e.state.password2,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{required:!0,id:"firstName",name:"firstName",label:"First name",fullWidth:!0,autoComplete:"first-name",variant:"standard",value:e.state.firstName,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{required:!0,id:"lastName",name:"lastName",label:"Last name",fullWidth:!0,autoComplete:"last-name",variant:"standard",value:e.state.lastName,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:2,children:Object(v.jsx)(z.a,{required:!0,id:"number",name:"number",label:"Number",fullWidth:!0,autoComplete:"shipping address-number",variant:"standard",value:e.state.number,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:10,children:Object(v.jsx)(z.a,{required:!0,id:"address1",name:"address1",label:"Address line 1",fullWidth:!0,autoComplete:"shipping address-line1",variant:"standard",value:e.state.address1,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{id:"address2",name:"address2",label:"Address line 2",fullWidth:!0,autoComplete:"shipping address-line2",variant:"standard",value:e.state.address2,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{required:!0,id:"city",name:"city",label:"City",fullWidth:!0,autoComplete:"shipping address-city",variant:"standard",value:e.state.city,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{id:"region",name:"region",label:"Region",fullWidth:!0,variant:"standard",value:e.state.region,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{required:!0,id:"postcode",name:"postcode",label:"Postcode",fullWidth:!0,autoComplete:"shipping postal-code",variant:"standard",value:e.state.postcode,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{required:!0,id:"country",name:"country",label:"Country",fullWidth:!0,autoComplete:"shipping country",variant:"standard",value:e.state.country,onChange:e.handleChange})})]})})})]})}function Y(e){return Object(v.jsxs)(a.Fragment,{children:[Object(v.jsx)(g.a,{variant:"h6",gutterBottom:!0,children:"Choose payment method"}),Object(v.jsxs)(W.a,{fullWidth:!0,children:[Object(v.jsx)(M.a,{id:"select-payment-method",children:"Payment method"}),Object(v.jsxs)(E.a,{labelId:"select-payment-method",id:"dselect-payment-method",value:e.paymentMethod,label:"Payment method",onChange:e.handlePaymentMethodSelected,children:[Object(v.jsx)(y.a,{value:"cash",children:"Cash"}),Object(v.jsx)(y.a,{value:"card",children:"Card"})]})]}),e.addPaymentMethod?Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{onClick:e.handleAddPaymentMethod,children:"close payment form"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),"card"===e.paymentMethod?Object(v.jsx)("div",{children:Object(v.jsxs)(p.a,{container:!0,spacing:3,children:[Object(v.jsx)(p.a,{item:!0,xs:12,md:6,children:Object(v.jsx)(z.a,{required:!0,id:"cardName",label:"Name on card",fullWidth:!0,autoComplete:"cc-name",variant:"standard",value:e.state.cardName,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,md:6,children:Object(v.jsx)(z.a,{required:!0,id:"cardNumber",label:"Card number",fullWidth:!0,autoComplete:"cc-number",variant:"standard",value:e.state.cardNumber,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,md:6,children:Object(v.jsx)(z.a,{required:!0,id:"expMonth",label:"Expiry month",fullWidth:!0,autoComplete:"cc-exp",variant:"standard",value:e.state.expMonth,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,md:6,children:Object(v.jsx)(z.a,{required:!0,id:"expYear",label:"Expiry year",fullWidth:!0,autoComplete:"cc-exp",variant:"standard",value:e.state.expYear,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,md:6,children:Object(v.jsx)(z.a,{required:!0,id:"cvc",label:"CVC",helperText:"Last three digits on signature strip",fullWidth:!0,autoComplete:"cc-csc",variant:"standard",value:e.state.cvc,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,md:6,children:Object(v.jsx)(L.a,{onClick:e.createPaymentMethod,children:"add card"})})]})}):null]}):Object(v.jsx)("button",{onClick:e.handleAddPaymentMethod,children:"add payment method"}),e.user&&"card"===e.paymentMethod&&!e.addPaymentMethod&&0!=e.user.payment_methods.length?Object(v.jsx)("div",{children:Object(v.jsxs)(W.a,{fullWidth:!0,children:[Object(v.jsx)(M.a,{id:"select-card",children:"Choose an existing card"}),Object(v.jsx)(E.a,{labelId:"select-card",id:"dselect-card",value:e.card,label:"Card",onChange:e.handleCardSelected,children:e.user.payment_methods.map((function(e){return Object(v.jsx)(y.a,{value:e,children:"xxxx-xxxx-".concat(e.last4)},e.id)}))})]})}):null]})}var R=n(254),V=n(241),H=n(234),Q=n(262),J=n(238);function Z(e){return console.log(e.card),Object(v.jsxs)(a.Fragment,{children:[Object(v.jsx)(g.a,{variant:"h6",gutterBottom:!0,children:"Order summary"}),Object(v.jsxs)(R.a,{disablePadding:!0,children:[e.cart.map((function(t){return Object(v.jsxs)(V.a,{sx:{py:1,px:0},children:[Object(v.jsx)(H.a,{primary:t.name,secondary:t.description}),Object(v.jsxs)(g.a,{variant:"body2",children:[t.price," ",e.currency]})]},t._id)})),Object(v.jsxs)(V.a,{sx:{py:1,px:0},children:[Object(v.jsx)(H.a,{primary:"Total"}),Object(v.jsxs)(g.a,{variant:"subtitle1",sx:{fontWeight:700},children:[e.cart.total_cart," ",e.currency]})]})]}),Object(v.jsxs)(p.a,{container:!0,spacing:2,children:[Object(v.jsxs)(p.a,{item:!0,xs:12,sm:6,children:[Object(v.jsx)(g.a,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:"Shipping"}),"delivery"===e.shippingMethod?Object(v.jsx)(X,{user:e.user}):Object(v.jsx)(g.a,{variant:"h7",gutterBottom:!0,sx:{mt:2},children:"Pick up"})]}),Object(v.jsxs)(p.a,{item:!0,container:!0,direction:"column",xs:12,sm:6,children:[Object(v.jsx)(g.a,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:"Payment details"}),"card"===e.paymentMethod?Object(v.jsxs)("div",{children:[Object(v.jsx)(p.a,{item:!0,children:Object(v.jsxs)(g.a,{gutterBottom:!0,children:["Card name: ",e.card.cardName]})}),Object(v.jsx)(p.a,{item:!0,children:Object(v.jsxs)(g.a,{gutterBottom:!0,children:["Card number: ",e.card.last4]})}),Object(v.jsx)(p.a,{item:!0,children:Object(v.jsxs)(g.a,{gutterBottom:!0,children:["Expire month: ",e.card.exp_month]})}),Object(v.jsx)(p.a,{item:!0,children:Object(v.jsxs)(g.a,{gutterBottom:!0,children:["Expire year: ",e.card.exp_year]})})]}):"Cash"]})]}),Object(v.jsx)(Q.a,{control:Object(v.jsx)(J.a,{color:"secondary",name:"payment-terms-and-conditions",value:"yes"}),label:"Checkbox to agree terms and conditions"})]})}var $=n(53),ee=Object($.a)("http://localhost:5000",{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"}}),te=["Shipping address","Payment details","Review your order"];Object(b.a)();function ne(e){var t=r.a.useState(0),n=Object(h.a)(t,2),c=n[0],s=n[1],i=r.a.useState({email:e.user?e.user.email:"",firstName:e.user?e.user.firstName:"",lastName:e.user?e.user.lastName:"",address1:e.user?e.user.address.line1:"",address2:"",number:"",city:"",region:"",postcode:"",country:"",cardName:"",cardNumber:"",expMonth:"",expYear:"",cvc:""}),l=Object(h.a)(i,2),b=l[0],m=l[1],p=r.a.useState({}),x=Object(h.a)(p,2),f=x[0],y=x[1],C=r.a.useState(),_=Object(h.a)(C,2),k=_[0],w=_[1],S=r.a.useState(!1),P=Object(h.a)(S,2),W=P[0],M=P[1],E=r.a.useState(""),z=Object(h.a)(E,2),B=z[0],T=z[1],K=r.a.useState(""),F=Object(h.a)(K,2),X=F[0],R=F[1],V=function(e){R(e.target.value)},H=function(e){T(e.target.value)},Q=function(){M(!W),T("card")},J=function(e){console.log(e.target.value),y(e.target.value)},$=function(e){m(Object(d.a)(Object(d.a)({},b),{},Object(o.a)({},e.target.id,e.target.value)))},ne=function(){var t=Object(j.a)(u.a.mark((function t(){var n,a,r,i,o,d,l,h,m;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(X||0!==c?"delivery"!==X||e.user||0!==c?"delivery"===X&&e.user&&0===c?(ae(),s(c+1)):"pick-up"!==X||e.user||0!==c?"pick-up"===X&&e.user&&0===c&&s(c+1):""!=b.email&&""!=b.password&&""!=b.password2?(console.log("Try sign in and if not existing sign up"),console.log(b),i=b.email,o=b.password,d=b.password2,O.a.post("/users/sign-up",{email:i,password:o,password2:d}).then(function(){var t=Object(j.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.data.errors){t.next=10;break}if(console.log(n.data.errors[0].msg),"Email already exists"!==n.data.errors[0].msg){t.next=8;break}return t.next=5,O.a.post("/users/sign-in",{email:i,password:o});case 5:t.sent,e.updateUser(),s(c+1);case 8:t.next=17;break;case 10:if(console.log(n.data),"User added!"!==n.data.msg){t.next=17;break}return t.next=14,O.a.post("/users/sign-in",{email:i,password:o});case 14:t.sent,e.updateUser(),s(c+1);case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())):console.log("Fill all fields"):""!=b.email&&""!=b.password&&""!=b.password2?(console.log("Try sign in and if not existing sign up"),console.log(b),n=b.email,a=b.password,r=b.password2,b.firstName,b.lastName,b.address1,b.address2,b.city,b.region,b.postcode,b.country,O.a.post("/users/sign-up",{email:n,password:a,password2:r}).then(function(){var e=Object(j.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.data.errors){e.next=9;break}if(console.log(t.data.errors[0].msg),"Email already exists"!==t.data.errors[0].msg){e.next=7;break}return e.next=5,O.a.post("/users/sign-in",{email:n,password:a}).then((function(){return ae()}));case 5:e.sent,s(c+1);case 7:e.next=15;break;case 9:if(console.log(t.data),"User added!"!==t.data.msg){e.next=15;break}return e.next=13,O.a.post("/users/sign-in",{email:n,password:a}).then((function(){return ae()}));case 13:e.sent,s(c+1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):console.log("Fill all fields"):console.log("Select a shipping method first"),1===c&&e.user&&(console.log(W),console.log(B),console.log(f),B?("cash"===B&&(console.log("Payment selected = cash. Go next."),s(c+1)),"card"===B&&(f||W||console.log("Please choose an existing payment method or add new one."),f&&(console.log("Card selected. Create payment intent. Go next."),k||ce(),s(c+1)),W&&!k&&(console.log("Create payment method"),re().then((function(){return ce().then((function(){return s(c+1)}))}))))):console.log("Please select a payment method")),c!==te.length-1||!e.user){t.next=21;break}if(console.log("active step === steps.length -1 = ".concat(te.length-1)),"card"!==B){t.next=10;break}se(),l={orderedBy:e.user._id,payment_method:f,address:e.user.address,payment_intent:{status:"succeeded",card:f},shipping_method:X,items:e.cart,total_cart:e.cart.total_cart},ee.emit("new_order",{order:l}),t.next=19;break;case 10:if("cash"!==B){t.next=19;break}return console.log("Add order to admin and user"),h={orderedBy:e.user._id,address:e.user.address,items:e.cart,payment_intent:{status:"succeeded",payment_method:"cash"},shipping_method:X,total_cart:e.cart.total_cart},console.log(h),t.next=16,O.a.post("/users/add-order",{order:h});case 16:m=t.sent,ee.emit("new_order",{order:h}),console.log(m.data);case 19:e.emptyCart(),e.onClose();case 21:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ae=function(){var t=Object(j.a)(u.a.mark((function t(){var n,a,r,c,s,i,o,d,l,j;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("edit user"),console.log(b),n=b.firstName,a=b.lastName,r=b.address1,c=b.address2,s=b.city,i=b.region,o=b.country,d=b.postcode,l=b.number,t.next=5,O.a.post("/users/edit-user",{firstName:n,lastName:a,address1:r,address2:c,city:s,region:i,country:o,postcode:d,number:l});case 5:j=t.sent,console.log(j.data),e.updateUser();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),re=function(){var t=Object(j.a)(u.a.mark((function t(){var n,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={number:b.cardNumber,exp_month:b.expMonth,exp_year:b.expYear,cvc:b.cvc},console.log(B),console.log(n),t.next=5,O.a.post("/users/add-payment-method",{type:B,card:n});case 5:a=t.sent,console.log(a.data),y(a.data.paymentMethod),Q(),e.updateUser();case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ce=function(){var t=Object(j.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("create payment intent"),console.log(f),console.log(e.cart.total_cart),t.next=5,O.a.post("/users/create-payment-intent",{payment_method:f.id,total_cart:100*e.cart.total_cart,cart:e.cart});case 5:n=t.sent,console.log(n.data),n.data.paymentIntent&&w(n.data.paymentIntent);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),se=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Place order"),e.next=3,O.a.post("/users/confirm-payment-intent",{payment_intent:k});case 3:t=e.sent,console.log(t.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){console.log(b),ee.on("new_order",(function(e){var t=e.order;console.log("new order"),console.log(t)}))}),[]),Object(v.jsx)(D.a,{component:"main",maxWidth:"sm",sx:{mb:4},children:Object(v.jsxs)(A.a,{variant:"outlined",sx:{my:{xs:3,md:6},p:{xs:2,md:3}},children:[Object(v.jsx)(g.a,{component:"h1",variant:"h4",align:"center",children:"Checkout"}),Object(v.jsx)(N.a,{activeStep:c,sx:{pt:3,pb:5},children:te.map((function(e){return Object(v.jsx)(q.a,{children:Object(v.jsx)(I.a,{children:e})},e)}))}),Object(v.jsx)(r.a.Fragment,{children:c===te.length?Object(v.jsxs)(r.a.Fragment,{children:[Object(v.jsx)(g.a,{variant:"h5",gutterBottom:!0,children:"Thank you for your order."}),Object(v.jsx)(g.a,{variant:"subtitle1",children:"Your order number is #2001539. We have emailed your order confirmation, and will send you an update when your order has shipped."})]}):Object(v.jsxs)(r.a.Fragment,{children:[function(t){switch(t){case 0:return Object(v.jsx)(G,{user:e.user,handleSignInDialog:e.handleSignInDialog,handleChange:$,state:b,editUser:ae,shippingMethod:X,handleShippingMethodSelect:V});case 1:return Object(v.jsx)(Y,{user:e.user,handleChange:$,state:b,card:f,handleCardSelected:J,handleAddPaymentMethod:Q,addPaymentMethod:W,paymentMethod:B,handlePaymentMethodSelected:H,createPaymentMethod:re});case 2:return Object(v.jsx)(Z,{state:b,handleChange:$,cart:e.cart,card:f,paymentMethod:B,shippingMethod:X,currency:e.currency,user:e.user});default:throw new Error("Unknown step")}}(c),Object(v.jsxs)(U.a,{sx:{display:"flex",justifyContent:"flex-end"},children:[0!==c&&Object(v.jsx)(L.a,{onClick:function(){s(c-1)},sx:{mt:3,ml:1},children:"Back"}),Object(v.jsx)(L.a,{variant:"contained",onClick:ne,sx:{mt:3,ml:1},children:c===te.length-1?"Place order":"Next"})]})]})})]})})}function ae(e){return Object(v.jsx)("div",{children:Object(v.jsx)(P.a,{open:e.open,onClose:e.onClose,children:Object(v.jsx)(ne,{user:e.user,updateUser:e.updateUser,handleSignInDialog:e.handleSignInDialog,cart:e.cart,onClose:e.onClose,emptyCart:e.emptyCart,currency:e.currency})})})}function re(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(W.a,{children:[Object(v.jsx)(M.a,{id:"select-currency-label",children:"Currency"}),Object(v.jsxs)(E.a,{labelId:"select-currency-label",id:"select-currency",value:e.currency,label:"Currency",onChange:e.handleCurrency,children:[Object(v.jsx)(y.a,{value:"GBP",children:"GBP"}),Object(v.jsx)(y.a,{value:"USD",children:"USD"}),Object(v.jsx)(y.a,{value:"EUR",children:"EUR"})]})]})})}function ce(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(W.a,{children:[Object(v.jsx)(M.a,{id:"select-theme-label",children:"Theme"}),Object(v.jsxs)(E.a,{labelId:"select-theme-label",id:"select-theme",value:e.theme,label:"Theme",onChange:e.handleTheme,children:[Object(v.jsx)(y.a,{value:"dark",children:"Dark"}),Object(v.jsx)(y.a,{value:"light",children:"Light"})]})]})})}function se(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(W.a,{fullWidth:!0,children:[Object(v.jsx)(M.a,{id:"demo-simple-select-label",children:"Demo"}),Object(v.jsxs)(E.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:e.demo,label:"Demo",onChange:e.handleDemo,children:[Object(v.jsx)(y.a,{value:"live-account",children:"Live account"}),Object(v.jsx)(y.a,{value:"user-demo",children:"As user"}),Object(v.jsx)(y.a,{value:"admin-demo",children:"As admin"})]})]})})}function ie(e){var t=r.a.useState(!1),n=Object(h.a)(t,2),a=n[0],c=n[1],s=function(){0===e.cart.length?console.log("Cart is empty. Don't open checkout dialog"):c(!a)};return console.log(e.notifications),Object(v.jsxs)("div",{children:[Object(v.jsx)(ae,{open:a,onClose:s,user:e.user,updateUser:e.updateUser,handleSignInDialog:e.handleSignInDialog,cart:e.cart,emptyCart:e.emptyCart,currency:e.currency}),Object(v.jsx)(k,{user:e.user,menuList:e.menuList,handleMenuList:e.handleMenuList,anchorEl:e.anchorEl,signOut:e.signOut,handleSelected:e.handleSelected,handleSignInDialog:e.handleSignInDialog,handleSignUpDialog:e.handleSignUpDialog}),Object(v.jsxs)(p.a,{container:!0,children:[Object(v.jsx)(p.a,{item:!0,xs:!0,children:Object(v.jsx)(S,{})}),Object(v.jsx)(p.a,{item:!0,xs:!0,children:Object(v.jsxs)(g.a,{children:["Total cart: ",e.cart.total_cart?e.cart.total_cart:0," ",e.currency]})}),Object(v.jsx)(p.a,{item:!0,xs:!0,children:Object(v.jsx)("button",{onClick:s,children:"checkout"})}),Object(v.jsx)(p.a,{item:!0,xs:!0,children:Object(v.jsx)(se,{demo:e.demo,handleDemo:e.handleDemo})}),Object(v.jsx)(p.a,{item:!0,xs:!0,children:Object(v.jsx)(re,{currency:e.currency,handleCurrency:e.handleCurrency})}),Object(v.jsx)(p.a,{item:!0,xs:!0,children:Object(v.jsx)(ce,{theme:e.theme,handleTheme:e.handleTheme})}),Object(v.jsx)(p.a,{item:!0,xs:!0,children:Object(v.jsx)(g.a,{children:e.notifications.length})}),Object(v.jsx)(p.a,{item:!0,xs:!0,children:Object(v.jsx)("button",{id:"menu-list-button",className:"Menu-button",onClick:e.handleMenuList,children:"menu"})})]})]})}var oe=n(265),de=function(e,t){for(var n=Object.values(e),a=Object.values(t),r=Object.keys(e),c=(Object.keys(t),[]),s=0;s<n.length;s++)for(var i=0;i<a.length;i++)if(s===i&&n[s]!=a[i]){var o={};o[r[s]]=n[s],c.push(o)}return c};function le(e){var t=r.a.useState(e.user.address),n=Object(h.a)(t,2),a=n[0],c=n[1],s=r.a.useState({username:e.user.username,email:e.user.email}),i=Object(h.a)(s,2),l=i[0],b=i[1],m=function(e){c(Object(d.a)(Object(d.a)({},a),{},Object(o.a)({},e.target.id,e.target.value))),b(Object(d.a)(Object(d.a)({},l),{},Object(o.a)({},e.target.id,e.target.value)))},p=function(){var t=Object(j.a)(u.a.mark((function t(){var n,r,c,s,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=de(a,e.user.address),r={},c=0;c<n.length;c++)s=Object.values(n[c])[0],i=Object.keys(n[c])[0],r[i]=s;if(l.username!=e.user.username&&(r.username=l.username),l.email!=e.user.email&&(r.email=l.email),0==Object.keys(r)){t.next=12;break}return console.log(r),t.next=9,O.a.post("/users/edit-user",r);case 9:o=t.sent,console.log(o.data),e.updateUser();case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(v.jsx)("div",{children:Object(v.jsxs)(P.a,{open:e.open,onClose:e.onClose,children:[Object(v.jsx)(z.a,{id:"username",onChange:m,label:"username",value:l.username}),Object(v.jsx)(z.a,{id:"email",onChange:m,label:"email",value:l.email}),Object(v.jsx)(z.a,{id:"city",onChange:m,label:"city",value:a.city}),Object(v.jsx)(z.a,{id:"country",onChange:m,label:"Country",value:a.country}),Object(v.jsx)(z.a,{id:"line1",onChange:m,label:"Line 1",value:a.line1}),Object(v.jsx)(z.a,{id:"number",onChange:m,label:"Number",value:a.number}),Object(v.jsx)(z.a,{id:"postcode",onChange:m,label:"Postcode",value:a.postcode}),Object(v.jsx)(z.a,{id:"region",onChange:m,label:"Region",value:a.region}),Object(v.jsx)(oe.a,{children:Object(v.jsx)(L.a,{onClick:p,children:"confirm"})})]})})}function ue(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(P.a,{open:e.open,onClose:e.onClose,children:[Object(v.jsxs)(W.a,{children:[Object(v.jsx)(M.a,{id:"select-payment-type",children:"Payment type"}),Object(v.jsx)(E.a,{labelId:"select-payment-type",id:"select-payment-type",value:e.card?e.card.type:"",label:"Payment type",onChange:e.handlePaymentTypeSelection,children:Object(v.jsx)(y.a,{value:"card",children:"Card"})})]}),Object(v.jsx)("br",{}),Object(v.jsx)(z.a,{id:"card_name",label:"Card name",onChange:e.handleChange}),Object(v.jsx)("br",{}),Object(v.jsx)(z.a,{id:"card_number",name:"Card number",label:"Card number",onChange:e.handleChange}),Object(v.jsx)("br",{}),Object(v.jsx)(z.a,{id:"exp_month",name:"Expire month",label:"Expire month",onChange:e.handleChange}),Object(v.jsx)("br",{}),Object(v.jsx)(z.a,{id:"exp_year",name:"Expire year",label:"Expire year",onChange:e.handleChange}),Object(v.jsx)("br",{}),Object(v.jsx)(z.a,{id:"cvc",name:"Cvc",label:"Cvc",onChange:e.handleChange}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:e.addPaymentMethod,children:"add payment method"}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:e.onClose,children:"close"})]})})}function je(e){return Object(v.jsx)("div",{children:Object(v.jsx)(P.a,{open:e.open,onClose:e.onClose,children:e.order?Object(v.jsxs)("div",{children:["Order id: ",e.order.order_id," or ",e.order._id,Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),"Address:",Object(v.jsx)("br",{}),"-Postcode: ",e.order.address.postcode,Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),"Items: ",e.order.items.map((function(e){return Object(v.jsxs)("div",{children:["Name: ",e.name]})})),Object(v.jsx)("br",{}),"Amount: ",e.order.total_amount/100]}):"loading"})})}function he(e){console.log(e.user);var t=r.a.useState(!1),n=Object(h.a)(t,2),a=n[0],c=n[1],s=r.a.useState(!1),i=Object(h.a)(s,2),l=i[0],b=i[1],m=r.a.useState(!1),p=Object(h.a)(m,2),x=p[0],g=p[1],f=r.a.useState(),y=Object(h.a)(f,2),C=y[0],_=y[1],k=r.a.useState(),w=Object(h.a)(k,2),S=w[0],P=w[1],U=function(){c(!a)},D=function(){b(!l)},A=function(){var t=Object(j.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get("/users/delete-user");case 2:n=t.sent,console.log(n.data),e.updateUser();case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),N=function(){var t=Object(j.a)(u.a.mark((function t(){var n,a,r,c,s,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("add payment method"),console.log(C),n=C.type,a=C.card_number,r=C.exp_month,c=C.exp_year,s=C.cvc,i={number:a,exp_month:r,exp_year:c,cvc:s},t.next=6,O.a.post("/users/add-payment-method",{type:n,card:i});case 6:o=t.sent,console.log(o.data),e.updateUser(),D();case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),q=function(){var t=Object(j.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n),console.log(e.user.customer_id),t.next=4,O.a.post("/users/detach-payment-method",{payment_method:n.id});case 4:a=t.sent,console.log(a.data),e.updateUser();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),I=function(){var t=Object(j.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n),t.next=3,O.a.post("/users/confirm-payment-intent",{payment_intent:n.id});case 3:a=t.sent,console.log(a.data),e.updateUser();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),W=function(){for(var t=e.orders,n=0;n<t.length;n++)for(var a=e.user.payment_intents,r=0;r<a.length;r++)t[n].payment_intent.id===a[r].id&&(P(t[n]),console.log(t[n]));g(!x)};return Object(v.jsxs)("div",{children:[Object(v.jsx)(le,{user:e.user,open:a,onClose:U,updateUser:e.updateUser}),Object(v.jsx)(ue,{open:l,onClose:D,addPaymentMethod:N,handleChange:function(e){_(Object(d.a)(Object(d.a)({},C),{},Object(o.a)({},e.target.id,e.target.value)))},handlePaymentTypeSelection:function(e){console.log(e.target),_(Object(d.a)(Object(d.a)({},C),{},{type:e.target.value}))},card:C}),Object(v.jsx)(je,{open:x,onClose:W,order:S}),"Username: ",e.user?e.user.username:null,Object(v.jsx)("br",{}),"Email: ",e.user?e.user.email:null,Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),"Address:",Object(v.jsx)("br",{}),"-City: ",e.user.address.city,Object(v.jsx)("br",{}),"-Country: ",e.user.address.country,Object(v.jsx)("br",{}),"-Line 1: ",e.user.address.line1,Object(v.jsx)("br",{}),"-Number: ",e.user.address.number,Object(v.jsx)("br",{}),"-Postcode: ",e.user.address.postcode,Object(v.jsx)("br",{}),"-Region: ",e.user.address.region,Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),"Payment Methods: ",e.user.payment_methods.map((function(e,t){return Object(v.jsxs)("div",{children:["-",t+1,": ",e.brand,", ","xxxx-xxxx-".concat(e.last4),Object(v.jsx)(L.a,{onClick:function(){return q(e)},children:"delete payment method"})]})})),Object(v.jsx)("br",{}),Object(v.jsx)(L.a,{onClick:D,children:"add payment method"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),"Payment Intents: ",e.user.payment_intents.map((function(e,t){return Object(v.jsxs)("div",{children:["-",t+1,": ",e.status," ",Object(v.jsx)(L.a,{onClick:W,children:"see order"}),"requires_confirmation"===e.status?Object(v.jsx)(L.a,{onClick:function(){return I(e)},children:"confirm payment intent"}):null]})})),Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:A,children:"delete account"}),Object(v.jsx)("button",{onClick:U,children:"edit account"})]})}var be=n(266),me=n(267),pe=n(268),xe=n.p+"static/media/pizza-margherita.f70cccca.jpeg";function Oe(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(T.a,{sx:{maxWidth:345},children:[Object(v.jsx)(be.a,{title:"Name: ".concat(e.item.name),subheader:"Price: ".concat(e.item.price," ").concat(e.currency)}),Object(v.jsx)(me.a,{component:"img",height:"194",image:xe,alt:"Pizza margherita"}),Object(v.jsxs)(K.a,{children:[Object(v.jsxs)(g.a,{variant:"h5",children:["Category: ",e.item.category]}),Object(v.jsxs)(g.a,{variant:"h5",children:["Description: ",e.item.description]}),Object(v.jsxs)(g.a,{variant:"h5",children:["Quantity: ",e.item.quantity]})]}),Object(v.jsx)(pe.a,{children:Object(v.jsx)("button",{onClick:function(){return e.deleteFromCart(e.item)},children:"delete from cart"})})]})})}function ge(e){return Object(v.jsx)("div",{children:e.cart?Object(v.jsx)(p.a,{container:!0,spacing:{xs:2,md:3},columns:{xs:4,sm:8,md:12},children:e.cart.map((function(t){return Object(v.jsx)(p.a,{item:!0,xs:2,children:Object(v.jsx)(Oe,{item:t,deleteFromCart:e.deleteFromCart,currency:e.currency})})}))}):null})}function fe(e){var t=r.a.useState(!1),n=Object(h.a)(t,2),a=n[0],c=n[1],s=r.a.useState(""),i=Object(h.a)(s,2),l=i[0],b=i[1],m=r.a.useState(""),p=Object(h.a)(m,2),x=p[0],g=p[1],f=r.a.useState({card_number:"",exp_month:"",exp_year:"",cvc:""}),C=Object(h.a)(f,2),_=C[0],k=C[1],w=function(){c(!a)},S=function(){var e=Object(j.a)(u.a.mark((function e(){var t,n,a,r,c,s,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_.card_number,n=_.exp_month,a=_.exp_year,r=_.cvc,c={number:t,exp_month:n,exp_year:a,cvc:r},s=l,e.next=5,O.a.post("/users/add-payment-method",{type:s,card:c});case 5:i=e.sent,console.log(i.data);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var t=Object(j.a)(u.a.mark((function t(){var n,a,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e.cart),!e.user){t.next=22;break}if(0!==e.user.payment_methods.length){t.next=6;break}console.log("user logged in ---\x3e No payment method ---\x3e Add a payment method first"),t.next=20;break;case 6:return console.log("user logged in ---\x3e Payment method existing ---\x3e Create payment intent"),console.log(e.cart.total_cart),console.log(x),t.next=11,O.a.post("/users/create-payment-intent",{payment_method:x,total_cart:100*e.cart.total_cart});case 11:return n=t.sent,console.log(n.data),a=n.data.paymentIntent,t.next=16,O.a.post("/users/confirm-payment-intent",{payment_intent:a});case 16:r=t.sent,console.log(r.data),e.updateUser(),e.handleSelected("user-orders");case 20:t.next=24;break;case 22:console.log("user logged out or not existing -----\x3e sign in/up"),e.handleSignInDialog();case 24:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(v.jsxs)("div",{children:[Object(v.jsx)(ue,{open:a,onClose:w,addPaymentMethod:S,handleChange:function(e){k(Object(d.a)(Object(d.a)({},_),{},Object(o.a)({},e.target.id,e.target.value)))},paymentTypeSelected:l,handlePaymentTypeSelection:function(e){b(e.target.value)}}),"Checkout",Object(v.jsx)("br",{}),"Total cart: ",e.cart.total_cart," ",e.currency,Object(v.jsx)("br",{}),e.user?Object(v.jsxs)("div",{children:[Object(v.jsxs)(W.a,{children:[Object(v.jsx)(M.a,{id:"select-payment-method",children:"Payment method"}),Object(v.jsx)(E.a,{labelId:"select-payment-method",id:"select-payment-method",value:x,label:"Payment method",onChange:function(e){g(e.target.value)},children:e.user.payment_methods.map((function(e){return Object(v.jsxs)(y.a,{value:e.id,children:["****",e.id]},e.id)}))})]}),Object(v.jsx)("br",{}),e.user.payment_methods.map((function(e){return e.id===x?"Show payment method details for ".concat(e.id):null})),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:w,children:"add payment method"}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:P,children:"confirm checkout"})]}):Object(v.jsxs)("div",{children:["Please sign in to confirm checkout",Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:e.handleSignInDialog,children:"sign in"})]})]})}function ye(e){var t=function(){var t=Object(j.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.post("/users/accept-order",{order:n});case 2:a=t.sent,console.log(a.data),e.updateUser();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n=function(){var t=Object(j.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.post("/users/delete-order",{order:n});case 2:a=t.sent,console.log(a.data),e.updateUser();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a=function(){var t=Object(j.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.post("/users/decline-order",{order:n});case 2:a=t.sent,console.log(a.data),e.updateUser();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(v.jsxs)("div",{children:["Users' orders",Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),e.user?e.user.orders.map((function(e){return Object(v.jsxs)("div",{id:e._id,children:["User id: ",e.user_id,Object(v.jsx)("br",{}),"Order id: ",e._id,Object(v.jsx)("br",{}),"Postcode: ",e.address.postcode,Object(v.jsx)("br",{}),"Accepted: ",e.accepted?"yes":"not",Object(v.jsx)("br",{}),e.items.map((function(e){return Object(v.jsxs)("div",{id:e._id,children:["Category: ",e.category,Object(v.jsx)("br",{}),"Name: ",e.name,Object(v.jsx)("br",{}),"Price: ",e.price,Object(v.jsx)("br",{}),"Description: ",e.description,Object(v.jsx)("br",{}),"Quantity: ",e.quantity]})})),Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:function(){return n(e)},children:"delete order"}),Object(v.jsx)("button",{onClick:function(){return t(e)},children:"accept order"}),Object(v.jsx)("button",{onClick:function(){return a(e)},children:"decline order"}),Object(v.jsx)("br",{}),Object(v.jsx)("br",{})]})})):null]})}var ve=n(269);function Ce(e){return Object(v.jsxs)("div",{children:["User's orders",Object(v.jsx)("br",{}),Object(v.jsx)("br",{}),Object(v.jsx)(Ue,{user:e.user,currency:e.currency})]})}function _e(e){return Object(v.jsx)("div",{children:Object(v.jsx)(P.a,{open:e.open,onClose:e.onClose,children:Object(v.jsx)(p.a,{container:!0,rowSpacing:1,columnSpacing:{xs:1,sm:2,md:3},children:0!=e.items.length?e.items.map((function(t){return Object(v.jsxs)(p.a,{item:!0,xs:8,children:[Object(v.jsxs)(g.a,{variant:"body2",children:["Category: ",t.category,Object(v.jsx)("br",{})]}),Object(v.jsxs)(g.a,{variant:"body2",children:["Name: ",t.name,Object(v.jsx)("br",{})]}),Object(v.jsxs)(g.a,{variant:"body2",children:["Price: ",t.price," ",e.currency,Object(v.jsx)("br",{})]}),Object(v.jsxs)(g.a,{variant:"body2",children:["Description: ",t.description,Object(v.jsx)("br",{})]}),Object(v.jsxs)(g.a,{variant:"body2",children:["Quantity: ",t.quantity]})]})})):"Loading"})})})}var ke=Object($.a)("https://tksbalti.uk/",{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"}});function we(e){var t=r.a.useState(),n=Object(h.a)(t,2),a=n[0],c=n[1],s=function(){var t=Object(j.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(a),console.log(e.order),t.next=4,O.a.post("/users/send-msg",{message:a,order_id:e.order._id});case 4:n=t.sent,ke.emit("message",{sentBy:e.user.username,text:a}),console.log(n.data),e.updateUser(),c("");case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(v.jsx)("div",{children:Object(v.jsxs)(P.a,{open:e.open,onClose:e.onClose,children:[0!=e.messages.length?Object(v.jsx)("div",{children:e.messages.map((function(e){return Object(v.jsxs)("div",{children:[Object(v.jsxs)(g.a,{children:[e.username,":"]}),Object(v.jsx)(g.a,{children:e.text})]})}))}):"No old messages",0!=e.chat.length?e.chat.map((function(e){return Object(v.jsxs)("div",{children:[Object(v.jsxs)(g.a,{children:[e.sentBy,":"]}),Object(v.jsx)(g.a,{children:e.text})]})})):null,Object(v.jsx)(z.a,{id:"message",value:a,onChange:function(e){c(e.target.value)}}),Object(v.jsx)(L.a,{onClick:s,children:"Send"})]})})}var Se=Object($.a)("http://localhost:5000",{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"}});function Pe(e){var t=function(){var t=Object(j.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.order),t.next=3,O.a.post("/users/accept-order",{order:e.order});case 3:n=t.sent,console.log(n.data),Se.emit("order_update",{order:e.order}),e.updateUser();case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=function(){var t=Object(j.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.order),t.next=3,O.a.post("/users/decline-order",{order:e.order});case 3:n=t.sent,console.log(n.data),Se.emit("order_update",{order:e.order}),e.updateUser();case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=function(){var t=Object(j.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.post("/users/start-delivery",{order:e.order});case 2:n=t.sent,console.log(n.data),Se.emit("order_update",{order:e.order});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r=function(){var t=Object(j.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.post("/users/end-delivery",{order:e.order});case 2:n=t.sent,console.log(n.data),Se.emit("order_update",{order:e.order});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(v.jsx)("div",{children:Object(v.jsx)(T.a,{children:Object(v.jsxs)(K.a,{children:[Object(v.jsx)(g.a,{variant:"h5",component:"div",children:"Date"}),Object(v.jsx)(g.a,{sx:{mb:1.5},color:"text.secondary",children:e.order.date}),e.user.admin?Object(v.jsxs)("div",{children:[Object(v.jsxs)(g.a,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:["User id: ",e.order.orderedBy]}),Object(v.jsxs)(g.a,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:["Order id: ",e.order._id]}),Object(v.jsx)(L.a,{onClick:t,children:"Accept"}),Object(v.jsx)(L.a,{onClick:n,children:"Decline/refund"}),Object(v.jsx)(L.a,{onClick:a,children:"Start delivery"}),Object(v.jsx)(L.a,{onClick:r,children:"End delivery"})]}):Object(v.jsx)("div",{children:Object(v.jsxs)(g.a,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:["Order id: ",e.order._id]})}),Object(v.jsxs)(g.a,{variant:"h5",component:"div",children:["Shipping method: ",e.order.shipping_method]}),Object(v.jsx)(g.a,{variant:"h5",component:"div",children:"Address details"}),Object(v.jsxs)(g.a,{sx:{mb:1.5},color:"text.secondary",children:[e.order.address.postcode,", ",e.order.address.number,", ",e.order.address.line1,", ",e.order.address.city,", ",e.order.address.region,", ",e.order.address.country]}),Object(v.jsx)(g.a,{variant:"h5",component:"div",children:"Payment details"}),Object(v.jsxs)(g.a,{sx:{mb:1.5},color:"text.secondary",children:[e.order.payment_intent.status,",",e.order.payment_intent.card?e.order.payment_intent.card.last4:e.order.payment_intent.payment_method]}),Object(v.jsxs)(g.a,{variant:"h5",component:"div",children:["Accepted: ",e.order.accepted?"yes":"not"]}),Object(v.jsxs)(g.a,{variant:"h5",component:"div",children:["Delivered: ",e.order.delivered?"yes":"not"]}),Object(v.jsxs)(g.a,{variant:"h5",component:"div",children:["Status: ",e.order.status?e.order.status:"to be accepted"]}),Object(v.jsxs)(g.a,{variant:"h5",component:"div",children:["Total amount: ",e.order.total_amount/100," ",e.currency]}),Object(v.jsx)(L.a,{onClick:function(){return e.handleItemsDialog(e.order.items)},children:"items"}),Object(v.jsx)(L.a,{onClick:function(){return e.handleMessagesDialog(e.order)},children:"Messages"})]})})})}function Ue(e){var t=r.a.useState(!1),n=Object(h.a)(t,2),a=n[0],c=n[1],s=r.a.useState(!1),i=Object(h.a)(s,2),o=i[0],d=i[1],l=r.a.useState(!1),u=Object(h.a)(l,2),j=u[0],b=u[1],m=r.a.useState([]),x=Object(h.a)(m,2),O=x[0],g=x[1],f=r.a.useState([]),y=Object(h.a)(f,2),C=y[0],_=y[1],k=r.a.useState(),w=Object(h.a)(k,2),S=w[0],P=w[1],U=function(e){a||_(e),c(!a)},D=function(e){o||(P(e),g(e.messages)),d(!o)};return Object(v.jsxs)("div",{children:[Object(v.jsx)(_e,{open:a,onClose:U,items:C,currency:e.currency}),Object(v.jsx)(we,{open:o,onClose:D,messages:O,setMessages:g,order:S,updateUser:e.updateUser,user:e.user,chat:e.chat}),e.user?e.user.admin?"<AdminUsersOrders orders={props.user.orders}/>":"<UserOrders orders={props.user.orders}/>":"Loading",Object(v.jsx)(ve.a,{children:Object(v.jsx)(Q.a,{control:Object(v.jsx)(J.a,{checked:j,onChange:function(){b(!j)}}),label:"Show only active"})}),Object(v.jsxs)(p.a,{container:!0,rowSpacing:1,columnSpacing:{xs:1,sm:2,md:3},children:[e.user&&e.orders?e.orders.map((function(t){return Object(v.jsx)(p.a,{item:!0,xs:6,children:j&&t.accepted?null:Object(v.jsx)(Pe,{user:e.user,order:t,handleItemsDialog:U,handleMessagesDialog:D,currency:e.currency,updateUser:e.updateUser})})})):null,0!=e.newOrders.length?e.newOrders.map((function(t){return Object(v.jsx)(p.a,{item:!0,xs:6,children:Object(v.jsx)(Pe,{user:e.user,order:t,handleItemsDialog:U,handleMessagesDialog:D,currency:e.currency,updateUser:e.updateUser})})})):null]})]})}function De(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(P.a,{onClose:e.onClose,open:e.open,children:[Object(v.jsx)(z.a,{onChange:e.onChange,id:"category",label:"Category",name:"category"}),Object(v.jsx)(z.a,{onChange:e.onChange,id:"name",label:"Name",name:"name"}),Object(v.jsx)(z.a,{onChange:e.onChange,id:"price",label:"Price",name:"price"}),Object(v.jsx)(z.a,{onChange:e.onChange,id:"description",label:"Description",name:"description"}),Object(v.jsx)("button",{onClick:e.addProductToProductsList,children:"add item"}),Object(v.jsx)("button",{onClick:e.onClose,children:"close"})]})})}function Ae(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(T.a,{sx:{maxWidth:345},children:[Object(v.jsx)(be.a,{title:"Name: ".concat(e.product.name),subheader:"Price: ".concat(e.product.price)}),Object(v.jsx)(me.a,{component:"img",height:"194",image:xe,alt:"Pizza margherita"}),Object(v.jsxs)(K.a,{children:["Description: ",e.product.description]}),Object(v.jsxs)(pe.a,{children:[Object(v.jsx)("button",{onClick:e.handleEditProduct,children:"edit product"}),Object(v.jsx)("button",{onClick:function(){return e.deleteProductFromProductsList(e.product)},children:"delete product"})]})]})})}function Ne(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(T.a,{sx:{maxWidth:345},children:[Object(v.jsx)(be.a,{title:Object(v.jsx)(z.a,{id:"name",label:"Name",onChange:e.handleChange}),subheader:Object(v.jsx)(z.a,{id:"price",label:"Price",onChange:e.handleChange})}),Object(v.jsx)(me.a,{component:"img",height:"194",image:xe,alt:"Pizza margherita"}),Object(v.jsxs)(K.a,{children:[Object(v.jsx)(z.a,{id:"description",label:"Description",onChange:e.handleChange}),Object(v.jsx)(z.a,{id:"category",label:"Category",onChange:e.handleChange})]}),Object(v.jsxs)(pe.a,{children:[Object(v.jsx)("button",{onClick:function(){return e.editProductList(e.product)},children:"confirm"}),Object(v.jsx)("button",{onClick:function(){return e.deleteProduct(e.product)},children:"delete"}),Object(v.jsx)("button",{onClick:e.handleEditable,children:"cancel"}),Object(v.jsx)("button",{children:"upload new image"})]})]})})}function qe(e){var t=r.a.useState(!1),n=Object(h.a)(t,2),c=n[0],s=n[1],i=r.a.useState(!1),l=Object(h.a)(i,2),b=l[0],m=l[1],x=r.a.useState([]),g=Object(h.a)(x,2),f=g[0],y=g[1],C=r.a.useState(),_=Object(h.a)(C,2),k=_[0],w=_[1],S=function(){s(!c)},P=function(){m(!b)},U=function(){var t=Object(j.a)(u.a.mark((function t(n){var a,r,c,s,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("edit product"),a=k.category,r=k.name,c=k.price,s=k.description,i={_id:n._id,category:a,name:r,price:c,description:s},t.next=5,O.a.post("/users/edit-item-in-products-list",{product:i});case 5:o=t.sent,console.log(o.data),e.updateProductsList();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=function(){var t=Object(j.a)(u.a.mark((function t(){var n,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("add product"),n={name:k.name,category:k.category,description:k.description,price:k.price},t.next=4,O.a.post("/users/add-item-to-products-list",{product:n});case 4:a=t.sent,console.log(a.data),e.updateProductsList(),P();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),A=function(){var t=Object(j.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.post("/users/delete-item-from-products-list",{product:n});case 2:a=t.sent,console.log(a.data),e.updateProductsList();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),N=function(e){w(Object(d.a)(Object(d.a)({},k),{},Object(o.a)({},e.target.id,e.target.value)))};return Object(a.useEffect)((function(){var t=function(){var t=[];return e.productsList.forEach((function(e){(0===t.length||t[t.length-1]!=e.category)&&t.push(e.category)})),t}();y(t)}),[]),Object(v.jsxs)("div",{children:[Object(v.jsx)(De,{open:b,onClose:P,addProductToProductsList:D,onChange:N}),"Admin products list",Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:P,children:"add product"}),Object(v.jsx)("br",{}),f?f.map((function(t){return Object(v.jsxs)("div",{children:[t,Object(v.jsx)(p.a,{container:!0,children:e.productsList?e.productsList.map((function(e){return e.category===t?Object(v.jsx)("div",{children:c?Object(v.jsx)(Ne,{product:e,editProductList:U,handleEditProduct:S}):Object(v.jsxs)("div",{children:[Object(v.jsx)(Ae,{product:e,handleEditProduct:S}),Object(v.jsx)("br",{})]})},e._id):null})):null})]})})):null,e.productsList?c?e.productsList.map((function(e){return Object(v.jsxs)("div",{children:[Object(v.jsx)(z.a,{id:"category",label:"Category",onChange:N}),Object(v.jsx)("br",{}),Object(v.jsx)(z.a,{id:"name",label:"Name",onChange:N}),Object(v.jsx)("br",{}),Object(v.jsx)(z.a,{id:"price",label:"Price",onChange:N}),Object(v.jsx)("br",{}),Object(v.jsx)(z.a,{id:"description",label:"Description",onChange:N}),Object(v.jsx)("br",{}),"Category: ",e.category,Object(v.jsx)("br",{}),"Name: ",e.name,Object(v.jsx)("br",{}),"Price: ",e.price,Object(v.jsx)("br",{}),"Description: ",e.description,Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:function(){return U(e)},children:"edit"}),Object(v.jsx)("button",{onClick:S,children:"cancel"})]},e._id)})):e.productsList.map((function(e){return Object(v.jsxs)("div",{children:["Category: ",e.category,Object(v.jsx)("br",{}),"Name: ",e.name,Object(v.jsx)("br",{}),"Price: ",e.price,Object(v.jsx)("br",{}),"Description: ",e.description,Object(v.jsx)("br",{}),Object(v.jsx)("button",{onClick:S,children:"edit product"}),Object(v.jsx)("button",{onClick:function(){return A(e)},children:"delete product"}),Object(v.jsx)("br",{})]},e._id)})):null]})}function Ie(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(T.a,{sx:{maxWidth:345},children:[Object(v.jsx)(be.a,{title:"Name: ".concat(e.product.name),subheader:"Price: ".concat(e.product.price," ").concat(e.currency)}),Object(v.jsx)(me.a,{component:"img",height:"194",image:xe,alt:"Pizza margherita"}),Object(v.jsxs)(K.a,{children:["Description: ",e.product.description]}),Object(v.jsxs)(pe.a,{children:["Quantity: ",e.product.quantity,Object(v.jsx)("button",{onClick:function(){return e.addToCart(e.product)},children:"add to cart"})]})]})})}function Le(e){var t=r.a.useState(!1),n=Object(h.a)(t,2),a=n[0],c=n[1],s=r.a.useState(!1),i=Object(h.a)(s,2),l=i[0],b=i[1],m=r.a.useState(),x=Object(h.a)(m,2),g=x[0],f=x[1],y=function(){b(!l)},C=function(){c(!a)},_=function(){var t=Object(j.a)(u.a.mark((function t(n){var a,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("edit"),console.log(g),console.log(n),a={_id:n._id,name:g.name,category:g.category,description:g.description,price:g.price},t.next=6,O.a.post("/users/edit-product",{product:a});case 6:r=t.sent,console.log(r.data),e.updateProductsList(),C();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),k=function(){var t=Object(j.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.post("/users/delete-product",{product:n});case 2:a=t.sent,console.log(a.data),e.updateProductsList();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),w=function(e){f(Object(d.a)(Object(d.a)({},g),{},Object(o.a)({},e.target.id,e.target.value)))},S=function(){var t=Object(j.a)(u.a.mark((function t(){var n,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("add product"),n={name:g.name,category:g.category,description:g.description,price:g.price},t.next=4,O.a.post("/users/add-product",{product:n});case 4:a=t.sent,console.log(a.data),e.updateProductsList(),y();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(v.jsxs)("div",{children:[Object(v.jsx)(De,{open:l,onClose:y,addProductToProductsList:S,onChange:w}),e.user&&e.user.admin?Object(v.jsxs)("div",{children:[Object(v.jsx)(L.a,{onClick:C,children:"Edit"}),Object(v.jsx)(L.a,{onClick:y,children:"Add product"})]}):null,Object(v.jsx)(p.a,{container:!0,direction:"column",spacing:{xs:2,md:3},columns:{xs:4,sm:8,md:12},children:e.productsList.map((function(t,n){return Object(v.jsxs)(p.a,{item:!0,container:!0,xs:2,sm:4,md:4,children:[n," ",t.category,Object(v.jsx)(p.a,{container:!0,spacing:{xs:2,md:3},columns:{xs:4,sm:8,md:12},children:t.products.map((function(t,n){return Object(v.jsx)(p.a,{item:!0,xs:2,children:a?Object(v.jsx)(Ne,{handleChange:w,handleEditable:C,deleteProduct:k,editProductList:_,currency:e.currency,product:t}):Object(v.jsx)(Ie,{product:t,addToCart:e.addToCart,currency:e.currency})})}))})]},n)}))})]})}function We(e){return"products"===e.selected?Object(v.jsxs)("div",{children:[e.user?"Hello ".concat(e.user.username):null,Object(v.jsx)(Le,{addToCart:e.addToCart,productsList:e.productsList,updateProductsList:e.updateProductsList,categories:e.categories,user:e.user,currency:e.currency})]}):"cart"===e.selected?Object(v.jsx)("div",{children:Object(v.jsx)(ge,{cart:e.cart,deleteFromCart:e.deleteFromCart,handleSelected:e.handleSelected,checkout:e.checkout,currency:e.currency})}):"user-orders"===e.selected?Object(v.jsx)("div",{children:Object(v.jsx)(Ce,{user:e.user,currency:e.currency})}):"admin-products-list"===e.selected?Object(v.jsxs)("div",{children:[e.user?"Hello ".concat(e.user.username):null,Object(v.jsx)(qe,{updateUser:e.updateUser,productsList:e.productsList,updateProductsList:e.updateProductsList})]}):"admin-users-orders"===e.selected?Object(v.jsx)("div",{children:Object(v.jsx)(ye,{user:e.user,updateUser:e.updateUser})}):"checkout"===e.selected?Object(v.jsx)("div",{children:Object(v.jsx)(fe,{cart:e.cart,user:e.user,updateUser:e.updateUser,handleSelected:e.handleSelected,handleSignInDialog:e.handleSignInDialog,currency:e.currency})}):"account"===e.selected?Object(v.jsx)("div",{children:Object(v.jsx)(he,{user:e.user,updateUser:e.updateUser,currency:e.currency,orders:e.orders})}):"orders"===e.selected?Object(v.jsx)("div",{children:Object(v.jsx)(Ue,{user:e.user,orders:e.orders,updateUser:e.updateUser,chat:e.chat,newOrders:e.newOrders})}):void 0}function Me(e){return Object(v.jsxs)("div",{children:[Object(v.jsxs)("button",{onClick:function(){return e.handleSelected("cart")},children:["cart ","total"]}),Object(v.jsx)("button",{onClick:function(){return e.handleSelected("products-list")},children:"products list"}),Object(v.jsx)("button",{onClick:function(){return e.handleSelected("cart")},children:"checkout"})]})}var Ee=n(270),ze=n(235),Be=n(252);function Te(e){return Object(v.jsxs)(g.a,Object(d.a)(Object(d.a)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["Copyright \xa9 ",Object(v.jsx)(Ee.a,{color:"inherit",href:"https://tksbalti.uk",children:"Tk's Balti"})," ",(new Date).getFullYear(),"."]}))}var Ke=Object(b.a)();function Fe(e){return Object(v.jsx)("div",{children:Object(v.jsx)(m.a,{theme:Ke,children:Object(v.jsxs)(D.a,{component:"main",maxWidth:"xs",children:[Object(v.jsx)(ze.a,{}),Object(v.jsxs)(U.a,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(v.jsx)(Be.a,{sx:{m:1,bgcolor:"secondary.main"}}),Object(v.jsx)(g.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(v.jsxs)(U.a,{noValidate:!0,sx:{mt:1},children:[Object(v.jsx)(z.a,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:e.handleChange}),Object(v.jsx)(z.a,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:e.handleChange}),Object(v.jsx)(Q.a,{control:Object(v.jsx)(J.a,{value:"remember",color:"primary"}),label:"Remember me"}),Object(v.jsx)(L.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},onClick:e.signIn,children:"Sign In"}),Object(v.jsxs)(p.a,{container:!0,children:[Object(v.jsx)(p.a,{item:!0,xs:!0,children:Object(v.jsx)(Ee.a,{href:"#",variant:"body2",children:"Forgot password?"})}),Object(v.jsx)(p.a,{item:!0,children:Object(v.jsx)(Ee.a,{href:"#",variant:"body2",onClick:function(){e.handleSignInDialog(),e.handleSignUpDialog()},children:"Don't have an account? Sign Up"})})]})]})]}),Object(v.jsx)(Te,{sx:{mt:8,mb:4}})]})})})}function Xe(e){return Object(v.jsx)("div",{children:Object(v.jsx)(P.a,{open:e.open,onClose:e.onClose,children:Object(v.jsx)(Fe,{signIn:e.signIn,handleChange:e.handleChange,handleSignInDialog:e.handleSignInDialog,handleSignUpDialog:e.handleSignUpDialog})})})}function Ge(e){return Object(v.jsxs)(g.a,Object(d.a)(Object(d.a)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["Copyright \xa9 ",Object(v.jsx)(Ee.a,{color:"inherit",href:"https://mui.com/",children:"Your Website"})," ",(new Date).getFullYear(),"."]}))}var Ye=Object(b.a)();function Re(e){return Object(v.jsx)(m.a,{theme:Ye,children:Object(v.jsxs)(D.a,{component:"main",maxWidth:"xs",children:[Object(v.jsx)(ze.a,{}),Object(v.jsxs)(U.a,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(v.jsx)(Be.a,{sx:{m:1,bgcolor:"secondary.main"}}),Object(v.jsx)(g.a,{component:"h1",variant:"h5",children:"Sign up"}),Object(v.jsxs)(U.a,{noValidate:!0,sx:{mt:3},children:[Object(v.jsxs)(p.a,{container:!0,spacing:2,children:[Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{autoComplete:"given-name",name:"firstName",required:!0,fullWidth:!0,id:"firstName",label:"First Name",autoFocus:!0,onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(z.a,{required:!0,fullWidth:!0,id:"lastName",label:"Last Name",name:"lastName",autoComplete:"family-name",onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"new-password",onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(z.a,{required:!0,fullWidth:!0,name:"password2",label:"Password",type:"password",id:"password2",autoComplete:"new-password2",onChange:e.handleChange})}),Object(v.jsx)(p.a,{item:!0,xs:12,children:Object(v.jsx)(Q.a,{control:Object(v.jsx)(J.a,{value:"allowExtraEmails",color:"primary"}),label:"I want to receive inspiration, marketing promotions and updates via email."})})]}),Object(v.jsx)(L.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},onClick:e.signUp,children:"Sign Up"}),Object(v.jsx)(p.a,{container:!0,justifyContent:"flex-end",children:Object(v.jsx)(p.a,{item:!0,children:Object(v.jsx)(Ee.a,{href:"#",variant:"body2",onClick:function(){e.handleSignInDialog(),e.handleSignUpDialog()},children:"Already have an account? Sign in"})})})]})]}),Object(v.jsx)(Ge,{sx:{mt:5}})]})})}function Ve(e){return Object(v.jsx)("div",{children:Object(v.jsx)(P.a,{open:e.open,onClose:e.onClose,children:Object(v.jsx)(Re,{signUp:e.signUp,handleChange:e.handleChange,handleSignInDialog:e.handleSignInDialog,handleSignUpDialog:e.handleSignUpDialog})})})}var He={_id:"1",email:"foo@gmail.com",username:"foo",customer_id:"cus_Kkb5hYEUsySlpA",cart:[],admin:!1,firstName:"foo",lastName:"the first",address:{postcode:"b1",line1:"streat",number:2,city:"birm",region:"wm",country:"uk"},payment_methods:[{cardName:"foo",id:"pm_1",fingerprint:"???",last4:4242,country:"US",exp_month:3,exp_year:2023,brand:"visa",_id:"1"}],payment_intents:[{id:"pi_3KBe7GAlUKnrAXrl1XseVP2y",status:"requires_confirmation",payment_method:"pm_1K5AEdAlUKnrAXrlK1cs7jFt"}],orders:[{order_id:"61caf8ce6dc16e80fdd427d9",payment_intent:{id:"pi_3KBe7GAlUKnrAXrl1XseVP2y",status:"requires_confirmation",payment_method:"pm_1K5AEdAlUKnrAXrlK1cs7jFt"},total_amount:2700,address:{postcode:"b1",line1:"streat",number:2,city:"birm",region:"wm",country:"uk"},items:[{_id:"618404787e861994a3063443",name:"pizza",price:10,description:"pizza margherita",category:"main",quantity:1}],accepted:!0,_id:"61caf8ce6dc16e80fdd427db",modifications:[{username:"foo",text:"I'm allergic to mushrooms",_id:"61caf8ec6dc16e80fdd4280a"}]},{order_id:"61caf8ce6dc16e80fdd427d1",payment_intent:{id:"pi_3KBe7GAlUKnrAXrl1XseVP2y",status:"requires_confirmation",payment_method:"pm_1K5AEdAlUKnrAXrlK1cs7jFt"},total_amount:2700,address:{postcode:"b1",line1:"streat",number:2,city:"birm",region:"wm",country:"uk"},items:[{_id:"618404787e861994a3063443",name:"pizza",price:10,description:"pizza margherita",category:"main",quantity:1}],accepted:!0,_id:"61caf8ce6dc16e80fdd427db",modifications:[{username:"foo",text:"I'm allergic to mushrooms",_id:"61caf8ec6dc16e80fdd4280a"}]},{order_id:"61caf8ce6dc16e80fdd427d2",payment_intent:{id:"pi_3KBe7GAlUKnrAXrl1XseVP2y",status:"requires_confirmation",payment_method:"pm_1K5AEdAlUKnrAXrlK1cs7jFt"},total_amount:2700,address:{postcode:"b1",line1:"streat",number:2,city:"birm",region:"wm",country:"uk"},items:[{_id:"618404787e861994a3063443",name:"pizza",price:10,description:"pizza margherita",category:"main",quantity:1}],accepted:!0,_id:"61caf8ce6dc16e80fdd427db",modifications:[{username:"foo",text:"I'm allergic to mushrooms",_id:"61caf8ec6dc16e80fdd4280a"}]},{order_id:"61caf8ce6dc16e80fdd427d3",payment_intent:{id:"pi_3KBe7GAlUKnrAXrl1XseVP2y",status:"requires_confirmation",payment_method:"pm_1K5AEdAlUKnrAXrlK1cs7jFt"},total_amount:2700,address:{postcode:"b1",line1:"streat",number:2,city:"birm",region:"wm",country:"uk"},items:[{_id:"618404787e861994a3063443",name:"pizza",price:10,description:"pizza margherita",category:"main",quantity:1}],accepted:!0,_id:"61caf8ce6dc16e80fdd427db",modifications:[{username:"foo",text:"I'm allergic to mushrooms",_id:"61caf8ec6dc16e80fdd4280a"}]}]},Qe={_id:"admin_id",email:"admin@gmail.com",username:"admin",customer_id:"cus_admin_id",cart:[],admin:!0,address:{postcode:"b1",line1:"streat",number:2,city:"birm",region:"wm",country:"uk"},payment_methods:[{cardName:"admin",id:"pm_admin",fingerprint:"???",last4:4242,country:"US",exp_month:3,exp_year:2023,brand:"visa",_id:"2"}],payment_intents:[],orders:[{user_id:"6234c8e19ee3119718d4dc08",total_amount:2700,payment_intent:{id:"pi_3Kek7dAlUKnrAXrl042AlrTI",status:"succeeded",payment_method:"pm_1Kek7FAlUKnrAXrlZd9wQAQm",_id:"6234c92b9ee3119718d4dd1c"},address:{postcode:"b1",line1:"streat",number:2,city:"birm",region:"wm",country:"uk"},items:[{_id:"618405197e861994a30726c8",name:"pizza",price:10,description:"peperoni",category:"main",quantity:1},{_id:"61a61a0fcad8e22d8c495760",name:"Lamb tikka",price:3.5,description:"tender pieces of lamb",category:"starters",quantity:2}],accepted:!1,delivered:!1,_id:"6234c9159ee3119718d4dc95",modifications:[]}]},Je=Object($.a)("https://tksbalti.uk/",{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"}});var Ze=function(){var e=r.a.useState({user:null}),t=Object(h.a)(e,2),n=t[0],c=t[1],s=r.a.useState(),l=Object(h.a)(s,2),x=l[0],g=l[1],f=r.a.useState("dark"),y=Object(h.a)(f,2),C=y[0],_=y[1],k=r.a.useState("GBP"),w=Object(h.a)(k,2),S=w[0],P=w[1],U=r.a.useState("live-account"),D=Object(h.a)(U,2),N=D[0],q=D[1],I=r.a.useState([]),L=Object(h.a)(I,2),W=L[0],M=L[1],E=r.a.useState([]),z=Object(h.a)(E,2),B=z[0],T=z[1],K=r.a.useState([]),F=Object(h.a)(K,2),X=F[0],G=F[1],Y=r.a.useState("products"),R=Object(h.a)(Y,2),V=R[0],H=R[1],Q=r.a.useState(!1),J=Object(h.a)(Q,2),Z=J[0],$=J[1],ee=r.a.useState(null),te=Object(h.a)(ee,2),ne=te[0],ae=te[1],re=r.a.useState(!1),ce=Object(h.a)(re,2),se=ce[0],oe=ce[1],de=r.a.useState(!1),le=Object(h.a)(de,2),ue=le[0],je=le[1],he=r.a.useState([]),be=Object(h.a)(he,2),me=be[0],pe=be[1],xe=r.a.useState([]),Oe=Object(h.a)(xe,2),ge=Oe[0],fe=(Oe[1],r.a.useState([])),ye=Object(h.a)(fe,2),ve=ye[0],Ce=ye[1],_e=Object(b.a)({palette:{mode:"dark"===C?"dark":"light"}}),ke=function(){je(!ue)},we=function(){oe(!se)},Se=function(e){H(e),$(!1)},Pe=function(e){return e.reduce((function(e,t){var n=e.find((function(e){return e.category===t.category})),a=t;return n?n.products.push(a):e.push({category:t.category,products:[a]}),e}),[])},Ue=function(){var e=Object(j.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("/users/update-products-list");case 2:t=e.sent,n=ze(t.data.products),a=Pe(t.data.products),console.log(a),T(n),M(a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),De=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("user-demo"!==N){e.next=4;break}c(Object(d.a)(Object(d.a)({},n),{},{user:He})),e.next=14;break;case 4:if("admin-demo"!==N){e.next=8;break}c(Object(d.a)(Object(d.a)({},n),{},{user:Qe})),e.next=14;break;case 8:return e.next=10,O.a.get("/users/");case 10:t=e.sent,console.log(t.data),g(t.data.orders),c(Object(d.a)(Object(d.a)({},n),{},{user:t.data.user}));case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(j.a)(u.a.mark((function e(){var t,a,r,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.email,a=n.password,e.next=3,O.a.post("/users/sign-in",{email:t,password:a});case 3:r=e.sent,s=r.data.user,console.log(s),s&&(c(Object(d.a)(Object(d.a)({},n),{},{user:s})),ke(),$(!1));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ne=function(){var e=Object(j.a)(u.a.mark((function e(){var t,a,r,s,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.email,a=n.password,r=n.password2,e.next=3,O.a.post("/users/sign-up",{email:t,password:a,password2:r});case 3:s=e.sent,(i=s.data.user)&&(c(Object(d.a)(Object(d.a)({},n),{},{user:i})),we(),$(!1));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),qe=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("/users/sign-out");case 2:e.sent,c({user:null}),H("products"),$(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ie=function(e){c(Object(d.a)(Object(d.a)({},n),{},Object(o.a)({},e.target.id,e.target.value)))},Le=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=X.slice(),console.log(t),0!==n.length&&t.quantity)for(a=0;a<n.length;a++)console.log(a,n[a]._id===t._id),n[a]._id===t._id&&n[a].quantity++;else t.quantity=1,n.push(t);r=Ee(n),n.total_cart=r,G(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(e){var t=0;return e.forEach((function(e){return t+=e.quantity*e.price})),t},ze=function(e){var t=[];return e.forEach((function(e){(0===t.length||t[t.length-1]!=e.category)&&t.push(e.category)})),t};return Object(a.useEffect)((function(){Ue(),De(),Je.on("connect_error",(function(e){console.log("connect_error due to ".concat(e.message)),console.log(e)})),Je.on("new_order",(function(e){var t=e.order;console.log("new order"),console.log(t),Ce([].concat(Object(i.a)(ve),["new order"])),De()})),Je.on("order_update",(function(e){var t=e.order;console.log("order update"),console.log(t),Ce([].concat(Object(i.a)(ve),["order update"])),De()})),Je.on("message",(function(e){var t=e.sentBy,n=e.text;Ce([].concat(Object(i.a)(ve),[n])),pe([].concat(Object(i.a)(me),[{sentBy:t,text:n}]))}))}),[N,V]),Object(v.jsx)("div",{children:Object(v.jsxs)(m.a,{theme:_e,children:[Object(v.jsx)(Xe,{open:ue,handleChange:Ie,onClose:ke,handleSignInDialog:ke,handleSignUpDialog:we,signIn:Ae}),Object(v.jsx)(Ve,{open:se,handleChange:Ie,onClose:we,handleSignInDialog:ke,handleSignUpDialog:we,signUp:Ne}),Object(v.jsx)(A.a,{children:Object(v.jsxs)(p.a,{container:!0,direction:"column",children:[Object(v.jsx)(p.a,{item:!0,children:Object(v.jsx)(ie,{user:n.user,signOut:qe,handleSelected:Se,handleMenuList:function(e){$(!Z),ae(e.currentTarget)},anchorEl:ne,menuList:Z,handleSignInDialog:ke,handleSignUpDialog:we,updateUser:De,cart:X,emptyCart:function(){G([])},handleDemo:function(e){q(e.target.value)},demo:N,currency:S,handleCurrency:function(e){P(e.target.value)},theme:C,handleTheme:function(e){_(e.target.value)},notifications:ve})}),Object(v.jsx)(p.a,{item:!0,children:Object(v.jsx)(We,{productsList:W,categories:B,selected:V,handleChange:Ie,user:n.user,cart:X,addToCart:Le,deleteFromCart:function(e){for(var t=X.slice(),n=0;n<t.length;n++)t[n]._id===e._id&&(1===t[n].quantity?(t[n].quantity=0,t.splice(X.indexOf(e),1)):t[n].quantity>1&&(t[n].quantity=t[n].quantity-1));var a=Ee(t);t.total_cart=a,G(t)},handleSelected:Se,updateUser:De,updateProductsList:Ue,handleSignInDialog:ke,currency:S,orders:x,chat:me,newOrders:ge})}),Object(v.jsx)(p.a,{item:!0,children:Object(v.jsx)(Me,{handleSelected:Se})})]})})]})})};s.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(Ze,{})}),document.getElementById("root"))}},[[187,1,2]]]);
//# sourceMappingURL=main.e4f22283.chunk.js.map